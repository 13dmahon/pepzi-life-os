// ====================================================
// Pepzi Frontend Snapshot
// Generated: Sat Nov 22 08:06:53 AM UTC 2025
// Working dir: /home/ascensionfd50/pepzi/frontend
// ====================================================

// ---------- PACKAGE & CONFIG ----------

// ========== package.json ==========
{
  "name": "frontend",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start"
  },
  "dependencies": {
    "@tanstack/react-query": "^5.90.10",
    "axios": "^1.13.2",
    "date-fns": "^4.1.0",
    "framer-motion": "^12.23.24",
    "lucide-react": "^0.554.0",
    "next": "16.0.3",
    "react": "19.2.0",
    "react-dom": "19.2.0",
    "zustand": "^5.0.8"
  },
  "devDependencies": {
    "@tailwindcss/postcss": "^4",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "tailwindcss": "^4",
    "typescript": "^5"
  }
}

// ========== tsconfig.json ==========
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts",
    "**/*.mts"
  ],
  "exclude": ["node_modules"]
}


// ---------- APP ROUTES (app/**/*.tsx) ----------

// ========== app/chat/page.tsx ==========
'use client';

import { useState } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { chatAPI } from '@/lib/api';
import { useUserStore } from '@/lib/store';
import { Message } from '@/types';
import { Send, Sparkles } from 'lucide-react';

export default function ChatPage() {
  const [input, setInput] = useState('');
  const [messages, setMessages] = useState<Message[]>([
    {
      id: '1',
      role: 'assistant',
      content: 'Hi! I\'m Pepzi, your AI life coach. Tell me what you\'d like to achieve, or just let me know what you did today!',
      timestamp: new Date(),
    }
  ]);
  const userId = useUserStore((state) => state.userId);
  const queryClient = useQueryClient();

  const sendMessageMutation = useMutation({
    mutationFn: (message: string) => chatAPI.sendMessage({ user_id: userId, message }),
    onSuccess: (data) => {
      const assistantMessage: Message = {
        id: Date.now().toString(),
        role: 'assistant',
        content: data.response,
        timestamp: new Date(),
        actions: data.actions_taken,
      };
      setMessages((prev) => [...prev, assistantMessage]);

      // Refresh goals or schedule if needed
      if (data.ui_updates.goals_refresh) {
        queryClient.invalidateQueries({ queryKey: ['goals'] });
      }
      if (data.ui_updates.schedule_refresh) {
        queryClient.invalidateQueries({ queryKey: ['schedule'] });
      }
    },
  });

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    if (!input.trim()) return;

    const userMessage: Message = {
      id: Date.now().toString(),
      role: 'user',
      content: input,
      timestamp: new Date(),
    };

    setMessages((prev) => [...prev, userMessage]);
    sendMessageMutation.mutate(input);
    setInput('');
  };

  return (
    <div className="flex flex-col h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50">
      {/* Header */}
      <div className="border-b bg-white/80 backdrop-blur-sm px-6 py-4 shadow-sm">
        <div className="max-w-4xl mx-auto flex items-center gap-3">
          <div className="w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center">
            <Sparkles className="w-6 h-6 text-white" />
          </div>
          <div>
            <h1 className="text-xl font-bold text-gray-900">Pepzi</h1>
            <p className="text-sm text-gray-500">Your AI Life Coach</p>
          </div>
        </div>
      </div>

      {/* Messages */}
      <div className="flex-1 overflow-y-auto px-6 py-8">
        <div className="max-w-4xl mx-auto space-y-6">
          {messages.map((message) => (
            <div
              key={message.id}
              className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}
            >
              <div
                className={`max-w-[80%] rounded-2xl px-6 py-4 ${
                  message.role === 'user'
                    ? 'bg-gradient-to-br from-purple-500 to-blue-500 text-white'
                    : 'bg-white shadow-md border border-gray-100'
                }`}
              >
                <p className={message.role === 'user' ? 'text-white' : 'text-gray-800'}>
                  {message.content}
                </p>
                {message.actions && message.actions.length > 0 && (
                  <div className="mt-3 pt-3 border-t border-purple-200">
                    <p className="text-xs text-purple-100 mb-2">Actions taken:</p>
                    {message.actions.map((action, idx) => (
                      <div key={idx} className="text-xs text-purple-100 flex items-center gap-2">
                        <span className="w-1.5 h-1.5 bg-purple-300 rounded-full" />
                        {action.type}: {action.data.log_id ? 'Logged' : 'Created'}
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          ))}
          {sendMessageMutation.isPending && (
            <div className="flex justify-start">
              <div className="bg-white shadow-md border border-gray-100 rounded-2xl px-6 py-4">
                <div className="flex gap-2">
                  <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce" />
                  <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce delay-100" />
                  <div className="w-2 h-2 bg-purple-400 rounded-full animate-bounce delay-200" />
                </div>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Input */}
      <div className="border-t bg-white/80 backdrop-blur-sm px-6 py-4">
        <form onSubmit={handleSubmit} className="max-w-4xl mx-auto">
          <div className="flex gap-3">
            <input
              type="text"
              value={input}
              onChange={(e) => setInput(e.target.value)}
              placeholder="Tell me what you did today, or what you want to achieve..."
              className="flex-1 px-6 py-4 rounded-full border border-gray-200 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition-all"
              disabled={sendMessageMutation.isPending}
            />
            <button
              type="submit"
              disabled={sendMessageMutation.isPending || !input.trim()}
              className="px-8 py-4 bg-gradient-to-br from-purple-500 to-blue-500 text-white rounded-full font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
            >
              <Send className="w-5 h-5" />
              Send
            </button>
          </div>
        </form>
      </div>
    </div>
  );
}

// ========== app/goals/page.tsx ==========
'use client';

import { useState } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { goalsAPI } from '@/lib/api';
import { useUserStore } from '@/lib/store';
import { Target, Plus, TrendingUp, Calendar } from 'lucide-react';

export default function GoalsPage() {
  const userId = useUserStore((state) => state.userId);
  const queryClient = useQueryClient();
  const [showExtract, setShowExtract] = useState(false);
  const [dreamsText, setDreamsText] = useState('');

  const { data: goals = [], isLoading } = useQuery({
    queryKey: ['goals', userId],
    queryFn: () => goalsAPI.getGoals(userId),
  });

  const extractMutation = useMutation({
    mutationFn: (text: string) => goalsAPI.extractFromDreams(userId, text),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['goals'] });
      setShowExtract(false);
      setDreamsText('');
    },
  });

  const getCategoryColor = (category: string) => {
    const colors: { [key: string]: string } = {
      fitness: 'from-green-500 to-emerald-500',
      money: 'from-yellow-500 to-orange-500',
      skill: 'from-blue-500 to-indigo-500',
      social: 'from-pink-500 to-rose-500',
      travel: 'from-purple-500 to-violet-500',
      habit: 'from-cyan-500 to-teal-500',
    };
    return colors[category] || 'from-gray-500 to-slate-500';
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50 p-8">
      <div className="max-w-6xl mx-auto">
        {/* Header */}
        <div className="flex items-center justify-between mb-8">
          <div>
            <h1 className="text-4xl font-bold text-gray-900 mb-2">Your Goals</h1>
            <p className="text-gray-600">Track your progress and achieve your dreams</p>
          </div>
          <button
            onClick={() => setShowExtract(true)}
            className="px-6 py-3 bg-gradient-to-br from-purple-500 to-blue-500 text-white rounded-full font-medium hover:shadow-lg transition-all flex items-center gap-2"
          >
            <Plus className="w-5 h-5" />
            Extract from Dreams
          </button>
        </div>

        {/* Extract Modal */}
        {showExtract && (
          <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
            <div className="bg-white rounded-2xl p-8 max-w-2xl w-full">
              <h2 className="text-2xl font-bold mb-4">Tell me your dreams</h2>
              <textarea
                value={dreamsText}
                onChange={(e) => setDreamsText(e.target.value)}
                placeholder="I want to run a marathon, learn Spanish fluently, and build a successful SaaS business..."
                className="w-full h-40 px-4 py-3 border border-gray-200 rounded-xl focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none resize-none"
              />
              <div className="flex gap-3 mt-4">
                <button
                  onClick={() => setShowExtract(false)}
                  className="flex-1 px-6 py-3 border border-gray-200 rounded-full font-medium hover:bg-gray-50"
                >
                  Cancel
                </button>
                <button
                  onClick={() => extractMutation.mutate(dreamsText)}
                  disabled={extractMutation.isPending || !dreamsText.trim()}
                  className="flex-1 px-6 py-3 bg-gradient-to-br from-purple-500 to-blue-500 text-white rounded-full font-medium hover:shadow-lg disabled:opacity-50"
                >
                  {extractMutation.isPending ? 'Extracting...' : 'Extract Goals'}
                </button>
              </div>
            </div>
          </div>
        )}

        {/* Goals Grid */}
        {isLoading ? (
          <div className="text-center py-20">
            <div className="inline-block w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin" />
          </div>
        ) : goals.length === 0 ? (
          <div className="text-center py-20">
            <Target className="w-16 h-16 text-gray-300 mx-auto mb-4" />
            <h3 className="text-xl font-semibold text-gray-600 mb-2">No goals yet</h3>
            <p className="text-gray-500 mb-6">Start by extracting goals from your dreams!</p>
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {goals.map((goal) => (
              <div
                key={goal.id}
                className="bg-white rounded-2xl p-6 shadow-md border border-gray-100 hover:shadow-xl transition-all"
              >
                <div className={`w-12 h-12 bg-gradient-to-br ${getCategoryColor(goal.category)} rounded-full flex items-center justify-center mb-4`}>
                  <Target className="w-6 h-6 text-white" />
                </div>
                <h3 className="text-xl font-bold text-gray-900 mb-2">{goal.name}</h3>
                <div className="flex items-center gap-2 text-sm text-gray-500 mb-4">
                  <span className="px-3 py-1 bg-purple-100 text-purple-700 rounded-full">
                    {goal.category}
                  </span>
                  {goal.target_date && (
                    <span className="flex items-center gap-1">
                      <Calendar className="w-4 h-4" />
                      {new Date(goal.target_date).toLocaleDateString()}
                    </span>
                  )}
                </div>
                {goal.progress && (
                  <div>
                    <div className="flex items-center justify-between mb-2">
                      <span className="text-sm font-medium text-gray-700">Progress</span>
                      <span className="text-sm font-bold text-purple-600">
                        {goal.progress.percent_complete}%
                      </span>
                    </div>
                    <div className="w-full h-2 bg-gray-100 rounded-full overflow-hidden">
                      <div
                        className={`h-full bg-gradient-to-r ${getCategoryColor(goal.category)} transition-all`}
                        style={{ width: `${goal.progress.percent_complete}%` }}
                      />
                    </div>
                    <p className="text-xs text-gray-500 mt-2">
                      {goal.progress.completed_micro_goals} of {goal.progress.total_micro_goals} milestones completed
                    </p>
                  </div>
                )}
              </div>
            ))}
          </div>
        )}
      </div>
    </div>
  );
}

// ========== app/layout.tsx ==========
import type { Metadata } from 'next';
import { Inter } from 'next/font/google';
import './globals.css';
import Providers from './providers';
import Navigation from '@/components/Navigation';

const inter = Inter({ subsets: ['latin'] });

export const metadata: Metadata = {
  title: 'Pepzi - AI Life OS',
  description: 'Your AI-powered life operating system',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <Providers>
          <Navigation />
          {children}
        </Providers>
      </body>
    </html>
  );
}

// ========== app/page.tsx ==========
import Link from 'next/link';
import { MessageSquare, Target, Calendar, Sparkles, TrendingUp, Zap } from 'lucide-react';

export default function HomePage() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50">
      {/* Hero Section */}
      <div className="max-w-6xl mx-auto px-6 py-20">
        <div className="text-center mb-16">
          <div className="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full mb-6 animate-pulse">
            <Sparkles className="w-10 h-10 text-white" />
          </div>
          <h1 className="text-6xl font-bold text-gray-900 mb-6">
            Welcome to <span className="bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">Pepzi</span>
          </h1>
          <p className="text-xl text-gray-600 mb-8 max-w-2xl mx-auto">
            Your AI-powered life operating system. Talk naturally, set goals, track progress, and achieve your dreams.
          </p>
          <Link
            href="/chat"
            className="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-br from-purple-500 to-blue-500 text-white rounded-full font-semibold text-lg hover:shadow-2xl transition-all transform hover:scale-105"
          >
            <MessageSquare className="w-6 h-6" />
            Start Chatting
          </Link>
        </div>

        {/* Features Grid */}
        <div className="grid md:grid-cols-3 gap-8 mt-20">
          <Link href="/chat" className="group">
            <div className="bg-white rounded-2xl p-8 shadow-lg border border-gray-100 hover:shadow-2xl transition-all transform hover:-translate-y-2">
              <div className="w-14 h-14 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                <MessageSquare className="w-7 h-7 text-white" />
              </div>
              <h3 className="text-2xl font-bold text-gray-900 mb-3">Natural Chat</h3>
              <p className="text-gray-600 leading-relaxed">
                Talk to Pepzi like a friend. "I ran 5km today" or "Book gym time next Tuesday at 6pm"
              </p>
            </div>
          </Link>

          <Link href="/goals" className="group">
            <div className="bg-white rounded-2xl p-8 shadow-lg border border-gray-100 hover:shadow-2xl transition-all transform hover:-translate-y-2">
              <div className="w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                <Target className="w-7 h-7 text-white" />
              </div>
              <h3 className="text-2xl font-bold text-gray-900 mb-3">Smart Goals</h3>
              <p className="text-gray-600 leading-relaxed">
                Extract goals from your dreams, track micro-milestones, and visualize progress
              </p>
            </div>
          </Link>

          <Link href="/schedule" className="group">
            <div className="bg-white rounded-2xl p-8 shadow-lg border border-gray-100 hover:shadow-2xl transition-all transform hover:-translate-y-2">
              <div className="w-14 h-14 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
                <Calendar className="w-7 h-7 text-white" />
              </div>
              <h3 className="text-2xl font-bold text-gray-900 mb-3">Auto Schedule</h3>
              <p className="text-gray-600 leading-relaxed">
                AI generates your schedule based on goals. Move blocks with natural language
              </p>
            </div>
          </Link>
        </div>

        {/* Stats */}
        <div className="grid md:grid-cols-3 gap-8 mt-20 text-center">
          <div>
            <div className="flex items-center justify-center gap-2 mb-2">
              <TrendingUp className="w-6 h-6 text-purple-500" />
              <div className="text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                100%
              </div>
            </div>
            <p className="text-gray-600">Natural Language</p>
          </div>
          <div>
            <div className="flex items-center justify-center gap-2 mb-2">
              <Zap className="w-6 h-6 text-blue-500" />
              <div className="text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                AI-Powered
              </div>
            </div>
            <p className="text-gray-600">OpenAI GPT-4</p>
          </div>
          <div>
            <div className="flex items-center justify-center gap-2 mb-2">
              <Sparkles className="w-6 h-6 text-indigo-500" />
              <div className="text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                Real-time
              </div>
            </div>
            <p className="text-gray-600">Progress Tracking</p>
          </div>
        </div>

        {/* CTA */}
        <div className="mt-20 text-center">
          <p className="text-gray-600 mb-4">Ready to transform your life?</p>
          <Link
            href="/chat"
            className="inline-flex items-center gap-2 text-purple-600 font-semibold hover:text-purple-700 transition-colors"
          >
            Start now <span className="text-2xl">â†’</span>
          </Link>
        </div>
      </div>
    </div>
  );
}

// ========== app/providers.tsx ==========
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { useState } from 'react';

export default function Providers({ children }: { children: React.ReactNode }) {
  const [queryClient] = useState(() => new QueryClient());

  return (
    <QueryClientProvider client={queryClient}>
      {children}
    </QueryClientProvider>
  );
}


// ---------- COMPONENTS (components/**/*.tsx) ----------

// ========== components/Navigation.tsx ==========
'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { MessageSquare, Target, Calendar, Home } from 'lucide-react';

export default function Navigation() {
  const pathname = usePathname();

  const links = [
    { href: '/', label: 'Home', icon: Home },
    { href: '/chat', label: 'Chat', icon: MessageSquare },
    { href: '/goals', label: 'Goals', icon: Target },
    { href: '/schedule', label: 'Schedule', icon: Calendar },
  ];

  return (
    <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 md:top-0 md:bottom-auto z-50">
      <div className="max-w-7xl mx-auto px-4">
        <div className="flex justify-around md:justify-start md:gap-8 py-3">
          {links.map(({ href, label, icon: Icon }) => {
            const isActive = pathname === href;
            return (
              <Link
                key={href}
                href={href}
                className={`flex items-center gap-2 px-4 py-2 rounded-full transition-all ${
                  isActive
                    ? 'bg-gradient-to-br from-purple-500 to-blue-500 text-white'
                    : 'text-gray-600 hover:bg-gray-100'
                }`}
              >
                <Icon className="w-5 h-5" />
                <span className="hidden md:inline font-medium">{label}</span>
              </Link>
            );
          })}
        </div>
      </div>
    </nav>
  );
}


// ---------- LIB / HOOKS / TYPES ----------

// ========== lib/api.ts ==========
import axios from 'axios';

const API_BASE_URL = 'https://pepzi-backend-1029121217006.us-central1.run.app';

export const api = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Types
export interface ChatMessage {
  user_id: string;
  message: string;
}

export interface ChatResponse {
  response: string;
  intents: any[];
  actions_taken: any[];
  ui_updates: {
    schedule_refresh: boolean;
    goals_refresh: boolean;
  };
}

export interface Goal {
  id?: string;
  user_id: string;
  name: string;
  category: string;
  target_date?: string;
  status?: string;
  plan?: any;
  progress?: any;
  created_at?: string;
  micro_goals?: any[];
}

// API functions
export const chatAPI = {
  sendMessage: async (data: ChatMessage): Promise<ChatResponse> => {
    const response = await api.post('/api/chat', data);
    return response.data;
  },
};

export const goalsAPI = {
  getGoals: async (userId: string): Promise<Goal[]> => {
    const response = await api.get(`/api/goals?user_id=${userId}`);
    return response.data.goals;
  },
  
  createGoal: async (goal: Goal): Promise<Goal> => {
    const response = await api.post('/api/goals', goal);
    return response.data.goal;
  },
  
  extractFromDreams: async (userId: string, text: string) => {
    const response = await api.post('/api/goals/from-dreams', {
      user_id: userId,
      text,
    });
    return response.data.goals;
  },
};

export const scheduleAPI = {
  getSchedule: async (userId: string, startDate?: string, endDate?: string) => {
    let url = `/api/schedule?user_id=${userId}`;
    if (startDate) url += `&start_date=${startDate}`;
    if (endDate) url += `&end_date=${endDate}`;
    const response = await api.get(url);
    return response.data.blocks;
  },
  
  getToday: async (userId: string) => {
    const response = await api.get(`/api/schedule/today?user_id=${userId}`);
    return response.data.blocks;
  },
};

// ========== lib/store.ts ==========
import { create } from 'zustand';
import { persist } from 'zustand/middleware';

interface UserStore {
  userId: string;
  setUserId: (id: string) => void;
}

export const useUserStore = create<UserStore>()(
  persist(
    (set) => ({
      userId: '550e8400-e29b-41d4-a957-146664440000', // Default test user
      setUserId: (id) => set({ userId: id }),
    }),
    {
      name: 'pepzi-user-storage',
    }
  )
);

// ========== types/index.ts ==========
export interface Message {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: Date;
  actions?: any[];
}

export interface Goal {
  id: string;
  user_id: string;
  name: string;
  category: string;
  target_date?: string;
  status: string;
  progress?: {
    percent_complete: number;
    completed_micro_goals: number;
    total_micro_goals: number;
  };
  micro_goals?: MicroGoal[];
}

export interface MicroGoal {
  id: string;
  goal_id: string;
  name: string;
  completed: boolean;
  order_index: number;
}

export interface ScheduleBlock {
  id: string;
  user_id: string;
  goal_id?: string;
  type: string;
  scheduled_start: string;
  duration_mins: number;
  status: string;
  notes?: string;
}

